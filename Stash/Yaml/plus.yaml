# Stash é…ç½®æ–‡ä»¶

mixed-port: 7890 # Mixedç«¯å£,ç”¨äºæ¥æ”¶mixinæ¨¡å¼å’Œvpnæ¨¡å¼çš„è¿æ¥è¯·æ±‚

# ä»£ç†æ¨¡å¼é…ç½®
proxy-servers:
  - name: ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
    type: vmess
    server: server1.com
    port: 443
    uuid: uuid1
    cipher: auto
    tls: true
    skip-cert-verify: true
    network: ws
    ws-path: /path1

  - name: ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹ 
    type: vmess
    server: server2.com   
    port: 443
    uuid: uuid2
    cipher: auto
    tls: true
    skip-cert-verify: true 
    network: ws
    ws-path: /path2

# ä»£ç†ç»„ç­–ç•¥
proxy-groups:
  - name: PROXY
    type: load-balance
    proxies:
      - ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
      - ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹
    url: http://www.gstatic.com/generate_204
    interval: 300

# åŸŸåè§£æ
dns:
  # é˜²æ±¡æŸ“DNS
  doh-servers:
    - https://dns.adguard.com/dns-query
  # é˜²DNSæ³„æ¼
  doh-default-servers:
    - https://dns.adguard.com/dns-query
  # åŠ«æŒæ‰€æœ‰DNS  
  hijack-dns-servers:
    - 8.8.8.8:53
    - 1.1.1.1:853

# å†…å®¹åŠ å¯†
tcp-emulators:
  - kcpsession
  - dpkgheader
  - kcpsession-ipv6
  - dpkgheader-ipv6

# è§„åˆ™æ–‡ä»¶
rule-providers:
  Reject:
    type: http
    behavior: domain
    url: https://ruleset-ipcidrx.site/reject.yaml
    path: ./ruleset/reject.yaml
  AdvertisingLite:
    type: http
    behavior: domain
    url: https://ruleset-ipcidrx.site/advertising-lite.yaml
    path: ./ruleset/ads.yaml
  Netflix:
    type: http
    behavior: domain
    url: https://ruleset-ipcidrx.site/netflix.yaml
    path: ./ruleset/stream.yaml        
  China:
    type: http
    behavior: domain
    url: https://ruleset-ipcidrx.site/china.yaml
    path: ./ruleset/china.yaml
  Domestic:
    type: http
    behavior: domain
    url: https://ruleset-ipcidrx.site/domestic.yaml
    path: ./ruleset/domestic.yaml    

# å†…æ ¸æ¨¡å¼
kernel-sockets: enable

# TUNè®¾ç½®
tun:
  enable: true 
  stack: system
  routing: separating
  route:
    - 192.168.0.0/16
    - 10.0.0.0/8
    - 172.16.0.0/12 
  dns-fallback: 4096
  allowed-icmp-types: []
  interface-name: utun10
  interface-metadata: 0

# DNSç›´è¿
dns-forwarding:
  lan:
    enabled: true
    listen: 7981

# é€æ˜ä»£ç†æ¨¡å¼é…ç½®
tcp-mux-transparent-proxy:
  enabled: true
  ipv6: false
  masquerade: 192.168.1.1
  packet-encoding: smcmux

  # NTAç©¿é€
  nata-tcp-mux:
    enabled: true 
    server-addr: 3.3.3.3
    extra-opts: []

# å…¶ä»–è®¾ç½®
mixed-port-transparent-proxy: true # MixedPorté€æ˜ä»£ç†æ¨¡å¼
inbound-settings: {} # UPD NAT mixinæ¨¡å¼
outbound-settings: {}

mtu-shift: -28 # é’ˆå¯¹MTUä¼˜åŒ–  
tcp-fast-open: true
vpn-type: meta-enhanced

tproxy-ipv6: false
tproxy-mark: 0x28 
router-mark: 0x6666

hijack-route:
  - tcp://0.0.0.0:7981 
  - udp://0.0.0.0:7981

hijack-dns:
  # DNSä¿®æ­£è§„åˆ™
  hijack-host:
    - ip.mesu.apple.com, 192.168.1.1

  # æ¸¸æˆ/è§†é¢‘å¢å¼ºè®¾ç½®
  tunouv: true
  tunaev: https://mqcdn.msf.qunarzz.com/mqfile/game/core.2.0.22.0.js 
  
  #éšè—è®¾å¤‡ä¿¡æ¯
  iface-name: rmnet0  
  iface-httplaceholder: "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/61.0.3163.79 Safari/537.36"

# è§„åˆ™åº”ç”¨
dns-policy: 
  cellular: DIRECT   
  wifi: DIRECT

proxy-policy:
  cellular: PROXY
  wifi: PROXY 

bypass-policy: {}
fallback-policy:
  cellular: PROXY
  wifi: PROXY
  
resouce-policy:
  direct: China,Domestic,Reject
  proxy: Netflix